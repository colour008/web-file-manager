<!DOCTYPE html>
<html lang="zh-CN">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>web文件管理器</title>
		<link rel="stylesheet" href="./styles.css" />
		<link
			rel="stylesheet"
			href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" />
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	</head>
	<body>
		<!-- 移动端侧边栏切换按钮 -->
		<button class="sidebar-toggle" id="sidebarToggle">
			<i class="fa-solid fa-bars"></i>
		</button>

		<!-- 剪贴板提示 -->
		<div class="clipboard-tip" id="clipboardTip"></div>

		<div class="sidebar" id="sidebar">
			<div class="sidebar-title">
				<i class="fas fa-folder-tree"></i>
				文件管理器
			</div>
			<div class="tip-text">
				💡 复制文件夹绝对路径粘贴至下方<br />示例：C:\Users\你的用户名\Desktop
				或 D:\test
			</div>
			<input
				type="text"
				class="path-input"
				id="pathInput"
				placeholder="请输入文件夹绝对路径" />
			<button class="confirm-btn" id="confirmBtn">
				<i class="fas fa-check-circle"></i> 确认加载
			</button>
			<button class="back-btn-sidebar" id="backBtnSidebar" disabled>
				<i class="fas fa-arrow-left"></i> 返回上级目录
			</button>
			<div class="tree-container" id="dirTree">
				<div class="empty-tip">请输入文件夹绝对路径并确认</div>
			</div>
		</div>
		<div class="content">
			<!-- 路径+搜索+按钮布局调整 -->
			<div class="content-header">
				<button class="back-btn-content" id="backBtnContent" disabled>
					<i class="fas fa-arrow-left"></i>
				</button>
				<div class="path-search-container">
					<div class="path-bar" id="pathBar">
						当前路径：未选择文件夹
					</div>
					<input
						type="text"
						class="search-input"
						id="searchInput"
						placeholder="🔍 搜索名称..." />
				</div>
				<button class="view-toggle-btn active" id="cardViewBtn">
					<i class="fas fa-th-large"></i> 卡片视图
				</button>
				<button class="view-toggle-btn" id="listViewBtn">
					<i class="fas fa-list"></i> 列表视图
				</button>
				<!-- 新增：导出Excel按钮 -->
				<button
					class="view-toggle-btn"
					id="exportExcelBtn"
					style="display: none">
					<i class="fas fa-file-excel"></i> 导出Excel
				</button>
			</div>

			<!-- 批量操作工具栏 -->
			<div class="batch-actions" id="batchActions">
				<span class="batch-count">已选择 <strong>0</strong> 项</span>
				<button class="batch-action-btn" id="batchDeleteBtn">
					<i class="fas fa-trash-alt"></i> 删除
				</button>
				<button class="batch-action-btn" id="batchCopyBtn">
					<i class="fas fa-copy"></i> 复制
				</button>
				<button class="batch-action-btn" id="batchMoveBtn">
					<i class="fas fa-cut"></i> 移动
				</button>
			</div>

			<div id="fileDisplayArea">
				<div class="empty-tip">请输入文件夹绝对路径并加载内容</div>
			</div>
		</div>

		<!-- 右键菜单 DOM（包含重命名/删除） -->
		<div class="context-menu" id="contextMenu">
			<div class="context-menu-item" id="menuOpen">
				<i class="context-menu-icon fas fa-folder-open"></i>
				<span>打开</span>
			</div>
			<div class="context-menu-separator"></div>
			<div class="context-menu-item" id="menuRename">
				<i class="context-menu-icon fas fa-edit"></i>
				<span>重命名</span>
			</div>
			<div class="context-menu-item" id="menuDelete">
				<i class="context-menu-icon fas fa-trash-alt"></i>
				<span>删除</span>
			</div>
			<div class="context-menu-separator"></div>
			<div class="context-menu-item" id="menuNewFolder">
				<i class="context-menu-icon fas fa-folder-plus"></i>
				<span>新建文件夹</span>
			</div>
			<div class="context-menu-item" id="menuNewFile">
				<i class="context-menu-icon fas fa-file-medical"></i>
				<span>新建文件</span>
			</div>
			<div class="context-menu-separator"></div>
			<div class="context-menu-item" id="menuCopy">
				<i class="context-menu-icon fas fa-copy"></i>
				<span>复制</span>
			</div>
			<div class="context-menu-item" id="menuCut">
				<i class="context-menu-icon fas fa-cut"></i>
				<span>剪切</span>
			</div>
			<div class="context-menu-item" id="menuPaste">
				<i class="context-menu-icon fas fa-paste"></i>
				<span>粘贴</span>
			</div>
		</div>

		<!-- 加载动画 -->
		<div class="loading-overlay" id="loadingOverlay">
			<div class="loading-spinner"></div>
			<div class="loading-text">加载中...</div>
		</div>

		<script src="./script.js"></script>
	</body>
</html>